<!DOCTYPE html>

<head>
    <meta charset="utf-8">

    <!-- Google fonts -->
    <link href='https://fonts.googleapis.com/css?family=Merriweather+Sans:400,700' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Playfair+Display:300,400' rel='stylesheet' type='text/css'>

    <!-- D3.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js" charset="utf-8"></script>
    <script src="https://d3js.org/queue.v1.min.js"></script>

    <!-- stats -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/stats.js/r14/Stats.js"></script> -->

    <!-- jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>

    <!-- Combobox script for the search box -->
    <script src="js/bootstrap-combobox.js"></script>
    <link href="css/bootstrap-combobox.css" rel="stylesheet">

    <!-- Stylesheet -->
    <link rel="stylesheet" href="css/style.css">

    <title>Külhoni Magyar Oktatási Adatfelfedező</title>

</head>

<body>
    <div id="cont" class="container-fluid inithidden2">

        <div class="row text-center" style="margin-top: 20px;">
            <div class="col-sm-4">
                <div class="titlebar">
                    <div class="col-sm-2 logo" style="max-width: 75px;">
                        <a href='https://bgazrt.hu/nemzetpolitikai-kutatointezet/' target='_blank'><img
                                src="img/npki.png"></a>
                    </div>
                    <div class="col-sm-10">
                        <a href='#' onclick='clicked(3);'><div id="topTitle" class="title">Külhoni Magyar<br>Oktatási Adatfelfedező</div></a>
                    </div>
                </div>
            </div>
            <div class="col-sm-8">
                <div id='menu'>
                    <div class="col-sm-4">
                        <a href='#' onclick='clicked(0);'><img src="img/BubblePlot150.png">&nbsp;&nbsp;&nbsp;<span
                                class='active'>Települések (2019)</span></a>
                    </div>
                    <div class="col-sm-4">
                        <a href='#' onclick='clicked(1);'><img
                                src="img/ScatterConnected150.png">&nbsp;&nbsp;&nbsp;<span>Éves változás
                                (2010-19)</span></a>
                    </div>
                    <div class="col-sm-4">
                        <a href='#' onclick='clicked(2);'><img
                                src="img/Heatmap150.png">&nbsp;&nbsp;&nbsp;<span>Adatfelfedező (2010-20)</span></a>
                    </div>
                </div>
            </div>
        </div>
        <div class="row text-center" style="margin-top: 20px;">
            <div class="col-sm-4" id='menu-col'>
                <div id="subTitle"></div>

                <div id="topText"></div>

                <hr>
                <div id='legendAndSearch'>
                    <div id="searchTitle" class="title">Írd be egy régió, megye/járás/körzet vagy település nevét:</div>
                    <div class="form-group">
                        <select id="searchBox" class="combobox input-large form-control" style="display: none;"
                            onchange="searchEvent(this.value)">
                            <option value="" selected="selected">Keresés régióra, megye/járás/körzetre vagy településre...</option>
                        </select>
                    </div>

                    <div class="row text-center" style="margin-top: 30px;">
                        <div class="col-sm-6">
                            <div id="legendTitle">Jelmagyarázat</div>
                            <div id="legendText">A buborékok mérete az adott településen nyilvántartott, magyarul tanuló
                                gyerekek számával arányos. A mérőszám az óvodás, illetve alsó és felső tagozatos
                                általános iskolás gyerekek összlétszámát jelöli.
                            </div>
                        </div>
                        <div id="legendRowWrapper" class="col-sm-6">
                            <div id="legendTitle2" style="text-align: center;">
                                <a href='#' onclick='sreload(0);'>
                                    <div class="col-sm-6 active2">Gyerekek</div>
                                </a>
                                <a href='#' onclick='sreload(1);'>
                                    <div class="col-sm-6">Intézmények</div>
                                </a>
                            </div><br><br>
                            <div class="legendSubTitle">2019-ben</div>
                            <div id="legendCircles"></div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="col-sm-8" id='chart-col' style='min-height:711px;'>
                <div id="chart"></div>
                <div id="school">
                    <img src='img/cerka.png' style='width:70%;margin-top:7%;'>
                </div>
                <div id='timeline' style="height:740px;" class="flourish-embed" data-src="story/728301">
                    <script src="https://public.flourish.studio/resources/embed.js"></script>
                </div>
                <div id='explorer' style="height:710px;overflow:hidden;">
                    <iframe width="100%" height="740"
                        src="https://app.powerbi.com/view?r=eyJrIjoiZWU1M2MyODItZjkyMi00NGE3LWE4NTktZTgxYWY1NzllNTc1IiwidCI6IjUxMGM0Y2MwLTdiMDctNGIyOC05Yjk5LWY2YzMzMDEwMjA5ZiIsImMiOjh9"
                        frameborder="0" allowFullScreen="true"></iframe>
                </div>
            </div>
        </div>

        <!-- Attribution -->
        <div class="row text-center">
            <div class="col-sm-12">
                <div id="attribution">
                    <span>Bethlen Gábor Alapkezelő Zrt. | <a href="https://bgazrt.hu/nemzetpolitikai-kutatointezet/"
                            target='_blank'>Nemzetpolitikai Kutatóintézet</a> |
                        Vizualizáció: <a href="https://data.csaladen.es" target='_blank'>Csala Dénes</a></span>
                </div>
            </div>
        </div>

    </div>

    <script src="js/script.js"></script>
    <script>
        var topText = ['Ez a vizualizáció az 1388 határon túli településen magyar nyelven tanuló 181553 óvodás és általános iskolás gyereket hivatott reprezentálni. A buborékok régiók, megyék/járások/körzetek és települések szerint csoportosítják a gyerekeket. Az egyes buborékokon belüli oszlopdiagramok az óvodás, illetve alsó- és felső tagozatos diákok számát jelöli, a 2019-es évben. Az egyes buborékokra kattintva közelítéssel böngészhetsz - vagy használhatod az alábbi keresőmezőt.',
            'Ez a vizualizáció egy átfogó képet ad a határon túli magyar nyelvű oktatásban zajló trendekről. A megjelenítési forma úgynevezett "változás-diagram", amely azt mutatja meg, hogy mekkora volt a százalékos változás a 2010 és a 2019-es évek között. A jobb oldalon, pozitív zónában elhelyezkedő pontok gyereklétszám-növekedést jelentenek az adott kategórára nézve, míg a negatív tartományban elhelyezkedő pontok csökkenést jeleznek. A hegedű-vonalak az pontok eloszlását jelölik, egy-egy kategórián belül. 6 dián mutatjuk be a gyereklétszám változásást régiónként, oktatási szintenként és osztályonként. A vizualizáció bal felső sarkában található nyilakra kattintva lépegethetsz a diák között. A színmmagyarázatok interaktívak, rájuk kattintva ki-be kapcsolhatod a különböző adat-kategóriákat.',
            'A szűrő jobb felső sarkában megjelenő radír ✏ ikonnal törölheted az összes kiválasztott szűrési kritériumot. Minden vizualizáció jobb felső sarkában találsz egy nagyítás ↗ ikont. Erre kattintva az adott vizualizáció kerül teljes képernyőn a a fókuszba.',
            'Impresszum, adatok forrása'
        ]

        var subTitle = ['Gyereklétszámok településenként és oktatási szintenként',
            'Gyereklétszámok 2010 és 2019 közöti százalékos változása',
            'Adatfelfedező eszköz',
            'Bemutató, a projekt részletes leírása'
        ]

        // d3.select('.titlebar').style('transform', 'translate(125%, 300%)')
        // d3.select('#menu').style('transform', 'translate(-25%, 550%)')

        function clicked(e) {
            console.log(e)
            d3.select('#topText').text(topText[e])
            d3.select('#subTitle').text(subTitle[e])
            d3.select('#chart').style('opacity', (e == 0) ? 1 : 0).style('z-index', (e == 0) ? 10 : 5)
            d3.select('#legendAndSearch').style('opacity', (e == 0) ? 1 : 0).style('z-index', (e == 0) ? 10 : 5)
            d3.select('#timeline').style('opacity', (e == 1) ? 1 : 0).style('z-index', (e == 1) ? 10 : 5)
            d3.select('#explorer').style('opacity', (e == 2) ? 1 : 0).style('z-index', (e == 2) ? 10 : 5)
            d3.select('#school').style('opacity', (e == 3) ? 1 : 0).style('z-index', (e == 2) ? 10 : 5)
            d3.select('#menu-col').attr('class', ((e == 0) || (e == 3)) ? 'col-sm-4' : 'col-sm-2').style('z-index', (e == 2) ? 10 : 5)

            d3.select('#menu').selectAll('.active2').classed('active2', false)
            d3.select(d3.select('#menu').selectAll('a').select('span')[0][e]).classed('active2', true)

        }

        function sreload(e) {
            d3.select('#legendTitle2').selectAll('.active2').classed('active2', false)
            d3.select(d3.select('#legendTitle2').selectAll('a').select('div')[0][e]).classed('active2', true)
            d3.select('#chart').selectAll('canvas').remove()
            d3.select('.combobox-container').remove()
            reload((e==0)?'':'2')    
        }

        clicked(3);
        // d3.select('#legendTitle').text(gyerekek + ' száma')

        reload('')
    </script>
</body>

</html>